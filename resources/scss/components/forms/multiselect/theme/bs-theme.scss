//
// Variables
// --------------------------------------------------

// Variables directly translating Bootstrap variables
// -------------------------

$s2bs-border-radius-base: $border-radius !default;
$s2bs-border-radius-large: $border-radius-lg !default;
$s2bs-border-radius-small: $border-radius-sm !default;
$s2bs-btn-default-bg: transparent !default;
$s2bs-btn-default-border: $dark !default;
$s2bs-btn-default-color: $dark !default;
$s2bs-caret-width-base: 0.25rem !default;
$s2bs-caret-width-large: 0.3125rem !default;
$s2bs-cursor-disabled: not-allowed !default;
$s2bs-dropdown-header-color: $dropdown-header-color !default;
$s2bs-dropdown-link-active-bg: $dropdown-link-active-bg !default;
$s2bs-dropdown-link-active-color: $dropdown-link-active-color !default;
$s2bs-dropdown-link-disabled-color: $dropdown-link-disabled-color !default;
$s2bs-dropdown-link-hover-bg: $dropdown-link-hover-bg !default;
$s2bs-dropdown-link-hover-color: $dropdown-link-hover-color !default;
$s2bs-font-size-base: $font-size-base !default;
$s2bs-font-size-large: $font-size-lg !default;
$s2bs-font-size-small: $custom-select-font-size-sm !default;
$s2bs-padding-base-horizontal: $custom-select-padding-y !default;
$s2bs-padding-large-horizontal: $input-btn-padding-y-lg !default;
$s2bs-padding-small-horizontal: $input-btn-padding-y-sm !default;
$s2bs-padding-base-vertical: $custom-select-padding-x !default;
$s2bs-padding-large-vertical: $input-btn-padding-x-lg !default;
$s2bs-padding-small-vertical: $input-btn-padding-x-sm !default;
$s2bs-line-height: 1 !default;
$s2bs-input-bg: $input-bg !default;
$s2bs-input-bg-disabled: $input-disabled-bg !default;
$s2bs-input-color: $input-color !default;
$s2bs-input-color-placeholder: $input-placeholder-color !default;
$s2bs-input-border: $input-border-color !default;
$s2bs-input-border-width: $input-btn-border-width !default;
$s2bs-input-border-focus: $input-focus-border-color !default;
$s2bs-input-border-radius: $input-border-radius !default;
$s2bs-input-height-base: $input-height !default;
$s2bs-input-height-large: $input-height-lg !default;
$s2bs-input-height-small: $input-height-sm !default;

// Theme-specific variables
// -------------------------

$s2bs-dropdown-arrow-color: $s2bs-input-color-placeholder !default;
$s2bs-dropdown-box-shadow: 0 6px 12px rgba(0, 0, 0, .175) !default;
$s2bs-dropdown-box-shadow-above: 0px -6px 12px rgba(0, 0, 0, .175) !default;
$s2bs-clear-selection-color: $s2bs-dropdown-arrow-color !default;
$s2bs-clear-selection-hover-color: $s2bs-btn-default-color !default;
$s2bs-remove-choice-color: $s2bs-input-color-placeholder !default;
$s2bs-remove-choice-hover-color: $s2bs-btn-default-color !default;
$s2bs-selection-choice-border-radius: $s2bs-border-radius-base !default;
$s2bs-dropdown-header-padding-vertical: $s2bs-padding-base-vertical !default;
$s2bs-dropdown-header-font-size: $s2bs-font-size-small !default;

// Bootstrap defaults not available as pre-defined variables
// These should not be overridden.
// -------------------------
$s2bs-form-control-default-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075) !default;
$s2bs-form-control-focus-box-shadow: $s2bs-form-control-default-box-shadow, 0 0 8px rgba($s2bs-input-border-focus, 0.6) !default;
$s2bs-form-control-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s !default;

//
// Mixins
// --------------------------------------------------
@mixin bootstrap-input-defaults($font-size: $s2bs-font-size-base) {
  @include box-shadow($s2bs-form-control-default-box-shadow);
  background-color: $s2bs-input-bg;
  border: $s2bs-input-border-width solid $s2bs-input-border;
  @include border-radius($s2bs-input-border-radius);
  color: $s2bs-input-color;
  font-size: $font-size;
}

@mixin validation-state-focus($color) {
  $shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 6px lighten($color, 20%);

  .select2-dropdown,
  .select2-selection {
    border-color: $color;
  }

  .select2-container--focus .select2-selection,
  .select2-container--open .select2-selection {
    @include box-shadow($shadow);
    border-color: darken($color, 10%);
  }

  &.select2-drop-active {
    border-color: darken($color, 10%);

    &.select2-drop.select2-drop-above {
      border-top-color: darken($color, 10%);
    }
  }
}

@mixin dropdown-arrow {
  .select2-selection--single {
    .select2-selection__arrow b {
      border-color: transparent transparent $s2bs-dropdown-arrow-color transparent;
      border-width: 0 $s2bs-caret-width-large $s2bs-caret-width-large $s2bs-caret-width-large;
    }
  }
}

.has-warning {
  @include validation-state-focus($warning);
}

.has-error {
  @include validation-state-focus($danger);
}

.has-success {
  @include validation-state-focus($success);
}

.input-group > .select2-hidden-accessible {
  &:first-child + .select2-container--bootstrap4 > .selection > .select2-selection,
  &:first-child + .select2-container--bootstrap4 > .selection > .select2-selection.form-control {
    @include border-right-radius(0);
  }

  &:not(:first-child) + .select2-container--bootstrap4:not(:last-child) > .selection > .select2-selection,
  &:not(:first-child) + .select2-container--bootstrap4:not(:last-child) > .selection > .select2-selection.form-control {
    border-radius: 0;
  }

  &:not(:first-child):not(:last-child) + .select2-container--bootstrap4:last-child > .selection > .select2-selection,
  &:not(:first-child):not(:last-child) + .select2-container--bootstrap4:last-child > .selection > .select2-selection.form-control {
    @include border-left-radius(0);
  }
}

.input-group > .select2-container--bootstrap4 {
  display: table;
  table-layout: fixed;
  position: relative;
  z-index: 2;
  width: 100%;
  margin-bottom: 0;

  > .selection > .select2-selection.form-control {
    float: none;
  }

  &.select2-container--open,
  &.select2-container--focus {
    z-index: 3;
  }

  &,
  .input-group-btn,
  .input-group-btn .btn {
    vertical-align: top;
  }
}

.form-control.select2-hidden-accessible {
  position: absolute !important;
  width: 1px !important;
}

.form-inline .select2-container--bootstrap4 {
  @include media-breakpoint-up(sm) {
    display: inline-block;
  }
}
